webpackJsonp([16],{"9gAC":function(t,a){},atAf:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("hxP8"),i=e("Au9i"),o={data:function(){return{bindCard:null,payPopupShow:!1,messageShow:!1,payShow:!1,addActive:!1,bankList:null,bankNum:"",discountMoney:"",bankType:"",orderNo:"",bindId:"",payment:"",paymentActual:"",bankCode:"",addressInfo:null,info:null,orderInfo:{productId:"",count:"",typeSel:null,productText:"",total:"",emsMoney:"",payTotal:""},shippingId:null}},computed:{},components:{homeHeader:s.a},methods:{getAddress:function(){var t=this,a=window.sessionStorage.getItem("tempMemberId")?window.sessionStorage.getItem("tempMemberId"):window.localStorage.getItem("memberId");t.ajax({url:"/shipping/get/one",method:"post",data:{memberId:a},success:function(a){1e3==a.status&&(t.addressInfo=a.data,t.shippingId=a.data.id)}})},createInfo:function(){var t=this;t.orderInfo.productId=t.$route.query.proId,t.orderInfo.count=t.$route.query.count,t.ajax({url:"/product/detail?id="+t.$route.query.proId,success:function(a){t.info=a.data,t.orderInfo.total=t.info.salesPrice*t.orderInfo.count,t.orderInfo.payTotal=t.info.discountPrice*t.orderInfo.count,t.discountMoney=t.orderInfo.total-t.orderInfo.payTotal}});var a="";if(t.$route.query.typeSel)for(var e=JSON.parse(t.$route.query.typeSel),s=0,i=e.length;s<i;s++)for(var o in e[s])a+=o+":"+e[s][o]+" ";t.orderInfo.typeSel=a},submitOrder:function(){var t=this;t.addressInfo?(t.ajax({url:"/order/create",method:"post",data:{memberId:window.localStorage.getItem("memberId"),productId:t.$route.query.proId,quantity:t.orderInfo.count,productText:"",shippingId:t.shippingId,remark:t.orderInfo.productText},success:function(a){1e3==a.status&&(t.orderNo=a.data.orderNo,t.payment=a.data.payment,t.paymentActual=a.data.paymentActual,t.payPopupShow=!0)}}),t.ajax({url:"/pay/cardlist",method:"post",success:function(a){var e=a.data.code,s=a.data.cardList;console.log(e),"1"==e?(t.bindCard=2,t.bankType=s[0].bankName,t.bankNum=s[0].cardNo,t.bindId=s[0].bindId,t.bankCode=s[0].bankCode,t.bankList=s):t.bindCard=1}})):Object(i.Toast)("您还未添加收获地址，请您添加收获地址")},bindBankCard:function(){this.ajax({url:"/pay/authUser?returnUrl=http://localhost:8080/createOrder",method:"post",success:function(t){var a=t.data.code;console.log(a);var e=t.data.redirectUrl;console.log(e),1==a&&(window.location.href=e)}})},rightPay:function(){this.ajax({url:"/pay/consume?bindCardId="+this.bindId+"&bankCode="+this.bankCode+"&id="+this.orderNo+"&webCallbackUrl=http://localhost:8080/result&payment=0.1&paymentActual=0.1",method:"post",success:function(t){var a=t.data.code,e=t.data.redirectUrl;1==a&&(window.location.href=e)}})}},watch:{payPopupShow:function(t){t||(this.addActive=!1,this.$router.push({name:"waitPay",query:{goback:"proDetail"}}))}},created:function(){this.getAddress(),this.createInfo()}},n={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"createOrder left"},[s("home-header",{attrs:{title:"订单确认",back:!0}}),t._v(" "),s("div",{staticClass:"create-main"},[s("div",{staticClass:"create-item create-main-address",on:{click:function(a){t.$router.push({name:"addressList",query:{goto:"1"}})}}},[s("div",{staticClass:"create-item-title"},[t._v("\n        收货地址：\n      ")]),t._v(" "),t.addressInfo?s("div",{staticClass:"create-address"},[s("div",{staticClass:"create-address-name"},[s("p",[t._v("收货人："+t._s(t.addressInfo.receiverName))]),t._v(" "),s("p",[t._v("手机："+t._s(t.addressInfo.receiverMobile))])]),t._v(" "),s("div",{staticClass:"create-address-content"},[t._v("\n          "+t._s(t.addressInfo.receiverProvince)+"省"+t._s(t.addressInfo.receiverCity)+t._s(t.addressInfo.receiverDistrict)+t._s(t.addressInfo.receiverAddress)+"\n        ")])]):s("div",{staticClass:"create-address"},[t._v("\n        您还未添加收获地址，请您添加收货地址\n      ")])]),t._v(" "),s("div",{staticClass:"create-item create-main-pay"},[s("div",{staticClass:"create-item-title create-top-arrows",on:{click:function(a){t.payShow=!t.payShow}}},[t._v("\n        支付方式："),s("i",{staticClass:"iconfont icon-jiantouxia",class:{active:t.payShow}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.payShow,expression:"payShow"}],staticClass:"create-item-content clear"},[s("i",{staticClass:"iconfont icon-danduduihao"}),s("span",[t._v("易宝支付")])])]),t._v(" "),s("div",{staticClass:"create-item create-main-message"},[s("div",{staticClass:"create-item-title create-top-arrows",on:{click:function(a){t.messageShow=!t.messageShow}}},[t._v("\n        订单附言："),s("i",{staticClass:"iconfont icon-jiantouxia",class:{active:t.messageShow}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.messageShow,expression:"messageShow"}],staticClass:"create-item-input"},[s("mt-field",{attrs:{placeholder:"请输入订单留言",type:"textarea",rows:"2",attr:{maxlength:50}},model:{value:t.orderInfo.productText,callback:function(a){t.$set(t.orderInfo,"productText",a)},expression:"orderInfo.productText "}})],1)]),t._v(" "),t.info?s("div",{staticClass:"create-item create-main-product"},[s("div",{staticClass:"create-product-title"},[t._v("\n        商品列表\n      ")]),t._v(" "),s("div",{staticClass:"create-product-item"},[s("div",{staticClass:"create-product-list"},[s("div",{staticClass:"create-product-image"},[s("img",{attrs:{src:t.imgHost+t.info.imgSrc,alt:""}})]),t._v(" "),s("div",{staticClass:"create-product-content"},[s("div",{staticClass:"create-product-name ellipsis"},[t._v("\n              "+t._s(t.info.productName)+"\n            ")]),t._v(" "),t.orderInfo.typeSel?s("div",{staticClass:"create-product-type"},[t._v("\n              "+t._s(t.orderInfo.typeSel)+"\n            ")]):t._e(),t._v(" "),s("div",{staticClass:"create-product-count"},[t._v("\n              数量："+t._s(t.orderInfo.count)+"\n            ")]),t._v(" "),s("div",{staticClass:"create-product-money"},[t._v("\n              价格："),s("span",[t._v("￥"+t._s(t.info.discountPrice)+"元")])])])])]),t._v(" "),s("div",{staticClass:"create-product-collect"},[s("p",[t._v("商品总价："),s("span",[t._v("￥"+t._s(t.orderInfo.total)+"元")])]),t._v(" "),t._e(),t._v(" "),s("p",[t._v("应付费用："),s("span",[t._v("￥"+t._s(t.orderInfo.payTotal)+"元")])])])]):t._e(),t._v(" "),s("div",{staticClass:"create-main-btn"},[s("span",{on:{click:t.submitOrder}},[t._v("订单提交")])])]),t._v(" "),s("mt-popup",{staticClass:"pay-mt-popup",attrs:{position:"bottom"},model:{value:t.payPopupShow,callback:function(a){t.payPopupShow=a},expression:"payPopupShow"}},[s("div",{staticClass:"pay-popup"},[s("div",{staticClass:"pay-title"},[s("div",{staticClass:"pay-title-cancel",on:{click:function(a){t.payPopupShow=!1}}},[t._v("\n          取消\n        ")]),t._v("\n        确认付款\n      ")]),t._v(" "),s("div",{staticClass:"pay-content"},[s("div",{staticClass:"pay-money"},[s("div",{staticClass:"pay-money-title"},[t._v("付款金额")]),t._v(" "),s("div",{staticClass:"pay-money-val"},[t._v("￥"+t._s(t.orderInfo.total))]),t._v(" "),s("div",{staticClass:"pay-money-refer"},[t._v("￥"+t._s(t.orderInfo.payTotal))])]),t._v(" "),s("div",{staticClass:"pay-price"},[s("div",{staticClass:"pay-price-title"},[t._v("优惠金额")]),t._v(" "),s("div",{staticClass:"pay-price-count"},[t._v("￥"+t._s(t.discountMoney))])]),t._v(" "),s("div",{staticClass:"pay-type"},[s("div",{staticClass:"pay-type-title"},[t._v("付款方式")]),t._v(" "),1==t.bindCard?s("div",{staticClass:"pay-type-content1",on:{click:function(a){t.bindBankCard()}}},[s("span",[t._v("您还没有绑定银行卡")]),s("i",{staticClass:"iconfont icon-arrow-right-copy"})]):t._e(),t._v(" "),2==t.bindCard?s("div",{staticClass:"pay-type-content",on:{click:function(a){t.addActive=!0}}},[s("div",{staticClass:"pay-type-img"},[s("img",{attrs:{src:e("tyII"),alt:""}})]),t._v(" "),s("div",{staticClass:"pay-type-right"},[s("div",{staticClass:"type-right-title"},[t._v("\n                "+t._s(t.bankNum)+"\n              ")]),t._v(" "),s("div",{staticClass:"type-right-num"},[t._v("\n                "+t._s(t.bankType)+"\n              ")])])]):t._e()]),t._v(" "),s("div",{staticClass:"pay-type-button"},[s("div",{staticClass:"pay-type-btn",on:{click:function(a){t.rightPay()}}},[t._v("确认支付")])]),t._v(" "),s("div",{staticClass:"pay-type-notice"},[t._v("\n          支持银行卡支付\n        ")])])]),t._v(" "),s("div",{staticClass:"pay-popup popup-add-pay",class:t.addActive?"moveLeft":"moveRight"},[s("div",{staticClass:"pay-title"},[s("div",{staticClass:"pay-title-cancel",on:{click:function(a){t.addActive=!1}}},[t._v("\n          返回\n        ")]),t._v("\n        选择付款方式\n      ")]),t._v(" "),s("div",{staticClass:"pay-content"},[s("div",{staticClass:"pay-type"},t._l(t.bankList,function(a){return s("div",{staticClass:"pay-type-content"},[s("div",{staticClass:"pay-type-img"},[s("img",{attrs:{src:e("tyII"),alt:""}})]),t._v(" "),s("div",{staticClass:"pay-type-right"},[s("div",{staticClass:"type-right-title"},[t._v("\n                "+t._s(a.cardNo)+"\n              ")]),t._v(" "),s("div",{staticClass:"type-right-num"},[t._v("\n                "+t._s(a.bankName)+"\n              ")])])])}))]),t._v(" "),s("div",{staticClass:"pay-add-code"},[t._v("\n        使用新卡支付\n      ")])])])],1)},staticRenderFns:[]};var r=e("VU/8")(o,n,!1,function(t){e("9gAC")},"data-v-4526e686",null);a.default=r.exports}});
//# sourceMappingURL=16.f5caf9d98c8fea36f045.js.map