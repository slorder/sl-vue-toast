webpackJsonp([25],{vBq5:function(t,a){},wpmp:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("hxP8"),i=e("Au9i"),c=e("ZY1l"),n={data:function(){return{bindCard:null,payPopupShow:!1,messageShow:!1,payShow:!1,addActive:!1,introduction:"",bankList:[],bankNum:"",bankType:"",orderNo:"",bindId:"",payment:"",paymentActual:"",bankCode:"",actualMoney:"",addressInfo:null,productLi:null,shippingId:""}},computed:{},components:{homeHeader:s.a},filters:{filterParse:c.a},methods:{getAddress:function(){var t=this,a=window.sessionStorage.getItem("tempMemberId")?window.sessionStorage.getItem("tempMemberId"):window.localStorage.getItem("memberId");t.ajax({url:"/shipping/get/one",method:"post",data:{memberId:a},success:function(a){1e3==a.status&&(t.addressInfo=a.data,t.shippingId=a.data.id)}})},createInfo:function(){var t=this,a=window.sessionStorage.getItem("tempMemberId")?window.sessionStorage.getItem("tempMemberId"):window.localStorage.getItem("memberId");t.ajax({url:"/cart/list?memberId="+a,success:function(a){t.productLi=a.data}})},submitOrder:function(){var t=this;t.addressInfo?(t.ajax({url:"/order/from/cart",method:"post",data:{memberId:window.localStorage.getItem("memberId"),shippingId:t.shippingId,productText:""},success:function(a){console.log(a.data.payment+"原价"),t.payment=a.data.payment,t.paymentActual=a.data.paymentActual,t.actualMoney=t.payment-t.paymentActual,t.orderNo=a.data.orderNo,t.payPopupShow=!0}}),t.ajax({url:"/pay/cardlist",method:"post",success:function(a){console.log(a.data.code);var e=a.data.code,s=a.data.cardList;console.log(e),"1"==e?(t.bindCard=2,t.bankType=s[0].bankName,t.bankNum=s[0].cardNo,t.bindId=s[0].bindId,t.bankCode=s[0].bankCode,t.bankList=s):t.bindCard=1}})):Object(i.Toast)("您还未添加收获地址，请您添加收获地址")},bindBankCard:function(){this.ajax({url:"/pay/authUser?returnUrl=http://localhost:8080/createOrder",method:"post",success:function(t){var a=t.body.code,e=t.body.redirectUrl;console.log(t.body.code),"US2016"!=a&&(window.location.href=e)}})},rightPay:function(){this.ajax({url:"/pay/consume?bindCardId="+this.bindId+"&bankCode="+this.bankCode+"&id="+this.orderNo+"&webCallbackUrl=http://localhost:8080/result&payment=0.1&paymentActual=0.1",method:"post",success:function(t){var a=t.data.code,e=t.data.redirectUrl;1==a&&(window.location.href=e)}})}},watch:{payPopupShow:function(t){t||(this.addActive=!1,this.$router.push({name:"waitPay",query:{goback:"proDetail"}}))}},created:function(){this.getAddress(),this.createInfo()}},o={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"createOrder left"},[s("home-header",{attrs:{title:"订单确认",back:!0}}),t._v(" "),s("div",{staticClass:"create-main"},[s("div",{staticClass:"create-item create-main-address",on:{click:function(a){t.$router.push({name:"addressList",query:{goto:"2"}})}}},[s("div",{staticClass:"create-item-title"},[t._v("\n        收货地址：\n      ")]),t._v(" "),t.addressInfo?s("div",{staticClass:"create-address"},[s("div",{staticClass:"create-address-name"},[s("p",[t._v("收货人："+t._s(t.addressInfo.receiverName))]),t._v(" "),s("p",[t._v("手机："+t._s(t.addressInfo.receiverMobile))])]),t._v(" "),s("div",{staticClass:"create-address-content"},[t._v("\n          "+t._s(t.addressInfo.receiverProvince)+"省"+t._s(t.addressInfo.receiverCity)+t._s(t.addressInfo.receiverDistrict)+t._s(t.addressInfo.receiverAddress)+"\n        ")])]):s("div",{staticClass:"create-address"},[t._v("\n        您还未添加收获地址，请您添加收货地址\n      ")])]),t._v(" "),s("div",{staticClass:"create-item create-main-pay"},[s("div",{staticClass:"create-item-title create-top-arrows",on:{click:function(a){t.payShow=!t.payShow}}},[t._v("\n        支付方式："),s("i",{staticClass:"iconfont icon-jiantouxia",class:{active:t.payShow}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.payShow,expression:"payShow"}],staticClass:"create-item-content clear"},[s("i",{staticClass:"iconfont icon-danduduihao"}),s("span",[t._v("易宝支付")])])]),t._v(" "),s("div",{staticClass:"create-item create-main-message"},[s("div",{staticClass:"create-item-title create-top-arrows",on:{click:function(a){t.messageShow=!t.messageShow}}},[t._v("\n        订单附言："),s("i",{staticClass:"iconfont icon-jiantouxia",class:{active:t.messageShow}})]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.messageShow,expression:"messageShow"}],staticClass:"create-item-input"},[s("mt-field",{attrs:{placeholder:"请输入订单留言",type:"textarea",rows:"2",attr:{maxlength:50}},model:{value:t.introduction,callback:function(a){t.introduction=a},expression:"introduction"}})],1)]),t._v(" "),t.productLi?s("div",{staticClass:"create-item create-main-product"},[s("div",{staticClass:"create-product-title"},[t._v("\n        商品列表\n      ")]),t._v(" "),s("div",{staticClass:"create-product-item"},t._l(t.productLi.cartProductDtoList,function(a,e){return s("div",{key:e,staticClass:"create-product-list"},[s("div",{staticClass:"create-product-image"},[s("img",{attrs:{src:t.imgHost+a.img,alt:""}})]),t._v(" "),s("div",{staticClass:"create-product-content"},[s("div",{staticClass:"create-product-name ellipsis"},[t._v("\n              "+t._s(a.productName)+"\n            ")]),t._v(" "),s("div",{staticClass:"create-product-count"},[t._v("\n              数量："+t._s(a.quantity)+" "),s("span",{staticClass:"total-count"},[t._v(" "+t._s(t._f("filterParse")(a.productText)))])]),t._v(" "),s("div",{staticClass:"create-product-money"},[t._v("\n              价格："),s("span",{staticClass:"total-money"},[t._v("￥"+t._s(a.productPrice)+"元")])])])])})),t._v(" "),s("div",{staticClass:"create-product-collect"},[s("p",[t._v("商品总价："),s("span",[t._v("￥"+t._s(t.productLi.cartTotalPrice)+"元")])]),t._v(" "),t._e(),t._v(" "),s("p",[t._v("应付费用："),s("span",[t._v("￥"+t._s(t.productLi.cartTotalPrice)+"元")])])])]):t._e(),t._v(" "),s("div",{staticClass:"create-main-btn"},[s("span",{on:{click:t.submitOrder}},[t._v("订单提交")])])]),t._v(" "),s("mt-popup",{staticClass:"pay-mt-popup",attrs:{position:"bottom"},model:{value:t.payPopupShow,callback:function(a){t.payPopupShow=a},expression:"payPopupShow"}},[s("div",{staticClass:"pay-popup"},[s("div",{staticClass:"pay-title"},[s("div",{staticClass:"pay-title-cancel",on:{click:function(a){t.payPopupShow=!1}}},[t._v("\n          取消\n        ")]),t._v("\n        确认付款\n      ")]),t._v(" "),s("div",{staticClass:"pay-content"},[s("div",{staticClass:"pay-money"},[s("div",{staticClass:"pay-money-title"},[t._v("付款金额")]),t._v(" "),s("div",{staticClass:"pay-money-val"},[t._v("￥"+t._s(t.paymentActual))]),t._v(" "),s("div",{staticClass:"pay-money-refer"},[t._v("￥"+t._s(t.payment))])]),t._v(" "),s("div",{staticClass:"pay-price"},[s("div",{staticClass:"pay-price-title"},[t._v("优惠金额")]),t._v(" "),s("div",{staticClass:"pay-price-count"},[t._v("￥"+t._s(t.actualMoney))])]),t._v(" "),s("div",{staticClass:"pay-type"},[s("div",{staticClass:"pay-type-title"},[t._v("付款方式")]),t._v(" "),1==t.bindCard?s("div",{staticClass:"pay-type-content1",on:{click:function(a){t.bindBankCard()}}},[s("span",[t._v("您还没有绑定银行卡")]),s("i",{staticClass:"iconfont icon-arrow-right-copy"})]):t._e(),t._v(" "),2==t.bindCard?s("div",{staticClass:"pay-type-content",on:{click:function(a){t.addActive=!0}}},[s("div",{staticClass:"pay-type-img"},[s("img",{attrs:{src:e("tyII"),alt:""}})]),t._v(" "),s("div",{staticClass:"pay-type-right"},[s("div",{staticClass:"type-right-title"},[t._v("\n                "+t._s(t.bankNum)+"\n              ")]),t._v(" "),s("div",{staticClass:"type-right-num"},[t._v("\n                "+t._s(t.bankType)+"\n              ")])])]):t._e()]),t._v(" "),s("div",{staticClass:"pay-type-button"},[s("div",{staticClass:"pay-type-btn",on:{click:function(a){t.rightPay()}}},[t._v("确认支付")])]),t._v(" "),s("div",{staticClass:"pay-type-notice"},[t._v("\n          支持银行卡支付\n        ")])])]),t._v(" "),s("div",{staticClass:"pay-popup popup-add-pay",class:t.addActive?"moveLeft":"moveRight"},[s("div",{staticClass:"pay-title"},[s("div",{staticClass:"pay-title-cancel",on:{click:function(a){t.addActive=!1}}},[t._v("\n          返回\n        ")]),t._v("\n        选择付款方式\n      ")]),t._v(" "),s("div",{staticClass:"pay-content"},[s("div",{staticClass:"pay-type"},t._l(t.bankList,function(a){return s("div",{staticClass:"pay-type-content"},[s("div",{staticClass:"pay-type-img"},[s("img",{attrs:{src:e("tyII"),alt:""}})]),t._v(" "),s("div",{staticClass:"pay-type-right"},[s("div",{staticClass:"type-right-title"},[t._v("\n                "+t._s(a.cardNo)+"\n              ")]),t._v(" "),s("div",{staticClass:"type-right-num"},[t._v("\n                "+t._s(a.bankName)+"\n              ")])])])}))]),t._v(" "),s("div",{staticClass:"pay-add-code"},[t._v("\n        使用新卡支付\n      ")])])])],1)},staticRenderFns:[]};var d=e("VU/8")(n,o,!1,function(t){e("vBq5")},"data-v-06cab818",null);a.default=d.exports}});
//# sourceMappingURL=25.d3067ce7b296c625dcdc.js.map